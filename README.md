# CVE-2023-33404

A user who has EditOwnPosts right on BlogEngine.NET CMS (version 3.3.8.0 and earlier) has the ability to upload a malicious file to a hard-coded location.

POST request to /api/upload endpoint with "action=video" parameters, as shown in the screenshot below, triggers a file upload process.

![image](https://github.com/hacip/CVE-2023-33404/assets/10704979/857ca69b-acaa-44c1-9c8b-c12c0fa42399)

The application, first, checks if the user has EditOwnPosts rights to proceed with the video upload, otherwise, the application rise an error.

As depicted in the screenshot below, on lines 101 and 105, the application sets a hard-coded location for files being uploaded. After that, it calls a function named UploadVideo (on line 107)

![image](https://github.com/hacip/CVE-2023-33404/assets/10704979/a677f85f-9227-4b96-b855-ef69b286f4b6)

The UploadVideo function. checks if the target directory exists, creates it if it does not, and saves the file to the directory.

![image](https://github.com/hacip/CVE-2023-33404/assets/10704979/710d71f3-8c71-47ec-86a7-6ef11d36a3ed)

As depicted in the screenshot below, it moves the malicious file to the hardcoded directory. Requesting the file that was uploaded leads RCE.

![image](https://github.com/hacip/CVE-2023-33404/assets/10704979/c93145de-f7e7-44d2-b2f4-ce357f5d3a11)
